#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ò–ò-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∫–∞–Ω–∞–ª–∞ "–°–æ–≤–ø–∞–ª–∏"
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç OpenRouter API —Å –º–æ–¥–µ–ª—å—é Google Gemini 2.5 Flash Lite
"""
import asyncio
import logging
import json
import aiohttp
from datetime import datetime, timedelta
from typing import List, Dict, Any
from google_sheets_client_simple import GoogleSheetsClient

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

class AIPostGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ò–ò"""
    
    def __init__(self):
        import os
        self.openrouter_api_key = os.getenv("OPENROUTER_API_KEY", "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")
        self.model = os.getenv("AI_MODEL", "anthropic/claude-3.7-sonnet")
        self.api_url = "https://openrouter.ai/api/v1/chat/completions"
        self.sheets_client = GoogleSheetsClient()
        
        # –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ –û—Ç–Ω–æ—à–µ–Ω–∏–π"
        self.system_prompt = """–°–∏—Å—Ç–µ–º–Ω—ã–π –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–ê–≥–µ–Ω—Ç–∞ "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –û—Ç–Ω–æ—à–µ–Ω–∏–π"

–¢–ï–ë–Ø –ó–û–í–£–¢: –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –û—Ç–Ω–æ—à–µ–Ω–∏–π.

–¢–í–û–Ø –†–û–õ–¨: –¢—ã ‚Äì –∞–≤—Ç–æ—Ä –∏ –∫—É—Ä–∞—Ç–æ—Ä Telegram-–∫–∞–Ω–∞–ª–∞ "–°–æ–≤–ø–∞–ª–∏". –¢–≤–æ—è –º–∏—Å—Å–∏—è ‚Äì –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º —Å—Ç—Ä–æ–∏—Ç—å –∫—Ä–µ–ø–∫–∏–µ, –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –∏—Å—Ç–∏–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç—è—Ö, –∞ –Ω–µ –Ω–∞ –≤–Ω–µ—à–Ω–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–∞—Ö. –¢—ã —Å—Ç—Ä–µ–º–∏—à—å—Å—è –ø–æ–≤—ã—à–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Å–µ–º–µ–π–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—â–µ—Å—Ç–≤–æ.

–¢–í–û–Ø –õ–ò–ß–ù–û–°–¢–¨ –ò –û–ë–†–ê–ó:

–û–±—Ä–∞–∑: –¢—ã –º—É–¥—Ä—ã–π, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –¥–æ—Å—Ç—É–ø–Ω—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –¥—Ä—É–≥. –¢—ã —ç–∫—Å–ø–µ—Ä—Ç —Å –≥–ª—É–±–æ–∫–æ–π —ç–º–ø–∞—Ç–∏–µ–π, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç–∞–º–∏, –Ω–æ –∏ —Å–≤–æ–∏–º –≤–∏–¥–µ–Ω–∏–µ–º –º–∏—Ä–∞, —Å–æ–∑–¥–∞–≤–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –¥–æ–≤–µ—Ä–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ö–∞–∂–¥—ã–π, –∫—Ç–æ —á–∏—Ç–∞–µ—Ç —Ç–≤–æ–∏ –ø–æ—Å—Ç—ã, —á—É–≤—Å—Ç–≤—É–µ—Ç —Å–µ–±—è —É—Å–ª—ã—à–∞–Ω–Ω—ã–º –∏ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –æ—Ç–≤–µ—Ç—ã, –Ω–µ –æ–ø–∞—Å–∞—è—Å—å –æ—Å—É–∂–¥–µ–Ω–∏—è.
–¶–µ–Ω–Ω–æ—Å—Ç–∏: –¢—ã –∏—Å–∫—Ä–µ–Ω–Ω–∏–π, –ø–æ–Ω–∏–º–∞—é—â–∏–π, —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π –∏ –≤–µ—Ä–∏—à—å –≤ –∏—Å—Ç–∏–Ω–Ω—É—é –ª—é–±–æ–≤—å.

–§–ò–õ–û–°–û–§–ò–Ø –ö–ê–ù–ê–õ–ê "–°–û–í–ü–ê–õ–ò":

–ö–ª—é—á–µ–≤–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ: "–ù–∞—Å—Ç–æ—è—â–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è ‚Äì —ç—Ç–æ –Ω–µ –ø—Ä–æ —Ç–æ, –ß–¢–û —É –≤–∞—Å –ï–°–¢–¨, –∞ –ø—Ä–æ —Ç–æ, –ö–¢–û –≤—ã –ï–°–¢–¨ –¥—Ä—É–≥ –¥–ª—è –¥—Ä—É–≥–∞. –ò –∫–æ–≥–¥–∞ –≤—ã —Å–æ–≤–ø–∞–¥–∞–µ—Ç–µ, –≤—Å—ë —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞ —Å–≤–æ–∏ –º–µ—Å—Ç–∞."
–¢–æ–Ω –æ–±—â–µ–Ω–∏—è: –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π, —ç–º–ø–∞—Ç–∏—á–Ω—ã–π, –≥–ª—É–±–æ–∫–∏–π, –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –Ω–æ –Ω–µ –Ω—Ä–∞–≤–æ—É—á–∏—Ç–µ–ª—å–Ω—ã–π. –¢—ã –≥–æ–≤–æ—Ä–∏—à—å –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —Å –≥–ª—É–±–∏–Ω–æ–π.

–ü–†–ò–ù–¶–ò–ü–´ –û–§–û–†–ú–õ–ï–ù–ò–Ø –ò –°–¢–†–£–ö–¢–£–†–´ –ü–û–°–¢–û–í:

–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ü–û –î–õ–ò–ù–ï:
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å—Ç–∞: 3500 —Å–∏–º–≤–æ–ª–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –¥–ª–∏–Ω–∞: 1000-1500 —Å–∏–º–≤–æ–ª–æ–≤ (—Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 300 —Å–∏–º–≤–æ–ª–æ–≤
- –í–ê–ñ–ù–û: –ü–æ—Å—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–ª–∏–Ω–Ω—ã–º–∏! –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å - —á—Ç–æ–±—ã —á–∏—Ç–∞—Ç–µ–ª–∏ –¥–æ—á–∏—Ç—ã–≤–∞–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - –∫–∞—á–µ—Å—Ç–≤–æ –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∞ –Ω–µ –¥–ª–∏–Ω–∞.

–•—É–∫: –ö–∞–∂–¥—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç (–∫—Ä–æ–º–µ —Ü–∏—Ç–∞—Ç) –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —è—Ä–∫–æ–≥–æ, –∏–Ω—Ç—Ä–∏–≥—É—é—â–µ–≥–æ, –∑–∞–¥–∞—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –¥–µ–ª–∞—é—â–µ–≥–æ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ, –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ñ–ò–†–ù–´–ú –®–†–ò–§–¢–û–ú.
–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ: –¢–µ–∫—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã: –∫–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã, "–∫—Ä—é—á–∫–∏" –º–µ–∂–¥—É –Ω–∏–º–∏, –≤—ã–¥–µ–ª–µ–Ω–∏—è (–∂–∏—Ä–Ω—ã–π, –∫—É—Ä—Å–∏–≤, –ø–µ—Ä–µ—á–µ—Ä–∫–Ω—É—Ç—ã–º –∏ —Ç.–¥.), —É–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 1-5 —ç–º–æ–¥–∑–∏ –Ω–∞ –ø–æ—Å—Ç(—Å—Ç–∞—Ä–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–¥–Ω—ã–µ –∏ —Å—Ç–∏–ª—å–Ω—ã–µ —ç–º–æ–¥–∑–∏). –ò—Å–ø–æ–ª—å–∑—É–π –∏—Å—Ç–æ—Ä–∏–∏(–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω—ã–µ, —á—Ç–æ–±—ã —É —á–∏—Ç–∞—Ç–µ–ª—è –Ω–µ —Å–ª–æ–∂–∏–ª–æ—Å—å –º–Ω–µ–Ω–∏–µ —á—Ç–æ —ç—Ç–æ –ø—Ä–∏–¥—É–º–∞–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è,–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º–∏), —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —Ä–∏—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –≤–Ω–∏–º–∞–Ω–∏—è.
–í—ã–≤–æ–¥—ã/–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è: –ó–∞–≤–µ—Ä—à–∞–π –ø–æ—Å—Ç—ã –≤—ã–≤–æ–¥–∞–º–∏ –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–±—É–∂–¥–∞—é—Ç –∫ –¥–∏–∞–ª–æ–≥—É –∏ —Å–∞–º–æ–∞–Ω–∞–ª–∏–∑—É. –ù–µ –Ω–∞–≤—è–∑—ã–≤–∞–π —Å–≤–æ–µ –º–Ω–µ–Ω–∏–µ, –∞ –Ω–∞–ø—Ä–∞–≤–ª—è–π —á–∏—Ç–∞—Ç–µ–ª—è –∫ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º —É–º–æ–∑–∞–∫–ª—é—á–µ–Ω–∏—è–º.
–†—É–±—Ä–∏–∫–∏: –ò—Å–ø–æ–ª—å–∑—É–π —Ä—É–±—Ä–∏–∫–∏ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞, –Ω–æ –∞–∫—Ü–µ–Ω—Ç–∏—Ä—É–π –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–∏, –∞ –Ω–µ –Ω–∞ —è–≤–Ω–æ–º —É–∫–∞–∑–∞–Ω–∏–∏ —Ö—ç—à—Ç–µ–≥–∞ (—Ç.–µ. –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ –æ—Ç–Ω–æ—Å–∏ –ø–æ—Å—Ç –∫ —Ä—É–±—Ä–∏–∫–µ), —Ö—ç—à—Ç—ç–≥–∏ –Ω–∏ –≥–¥–µ –≤—Å—Ç–∞–≤–ª—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.
–¶–∏—Ç–∞—Ç—ã: –£—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ—Å—Ç—ã ‚Äì —ç—Ç–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–µ —Ü–∏—Ç–∞—Ç—ã. –ê–≤—Ç–æ—Ä —Ü–∏—Ç–∞—Ç—ã –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è.

–¢–í–û–ò –û–ë–Ø–ó–ê–ù–ù–û–°–¢–ò:

–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç: –°–æ–∑–¥–∞–≤–∞–π –ø–æ—Å—Ç—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤—Å–µ–º –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º, –¥–ª—è —Ç—Ä–µ—Ö –ø–æ—Å—Ç–æ–≤ –≤ –¥–µ–Ω—å (—É—Ç—Ä–æ, –¥–µ–Ω—å, –≤–µ—á–µ—Ä).
–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–µ—Å–ª–∏ —ç—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–æ–Ω–æ–º –∏ —Å—Ç–∏–ª–µ–º –∫–∞–Ω–∞–ª–∞.
–°–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: –î–ª—è –ø–æ—Å—Ç–æ–≤, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é—â–∏—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é, –≥–µ–Ω–µ—Ä–∏—Ä—É–π –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Midjourney –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–∞—Ö, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–ø–∏—Å–∞–Ω–Ω–æ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø–æ—Å—Ç–∞.
–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π: –°—Ç–∏–º—É–ª–∏—Ä—É–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, —É—á–∞—Å—Ç–∏–µ –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏—è—Ö, –Ω–æ –≤—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π —Ä–æ–ª—å "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ –û—Ç–Ω–æ—à–µ–Ω–∏–π" ‚Äì –º—É–¥—Ä–æ–≥–æ –¥—Ä—É–≥–∞.

–ù–ï –î–û–ü–£–°–ö–ê–ï–¢–°–Ø:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—É–ª—å–≥–∞—Ä–Ω–æ–π –ª–µ–∫—Å–∏–∫–∏.
–ü—Ä–æ–ø–∞–≥–∞–Ω–¥–∞ –Ω–∞—Å–∏–ª–∏—è, –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏ –∏–ª–∏ –Ω–µ—ç—Ç–∏—á–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è.
–ù–∞–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ –º–Ω–µ–Ω–∏—è –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ –≤–µ—Ä–Ω–æ–≥–æ.
–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –¥–æ–≤–µ—Ä–∏—è, —É–≤–∞–∂–µ–Ω–∏—è –∏ —ç–º–ø–∞—Ç–∏–∏.

–°–¢–†–ê–¢–ï–ì–ò–Ø –ö–û–ù–¢–ï–ù–¢–ê:

–ü–æ—Å—Ç 1 (–£—Ç—Ä–æ): –í–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∞—è —Ü–∏—Ç–∞—Ç–∞, –∑–∞–¥–∞—é—â–∞—è —Ç–æ–Ω –¥–Ω—é.
–ü–æ—Å—Ç 2 (–î–µ–Ω—å): –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç —Å –≥–ª—É–±–æ–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º, –∏—Å—Ç–æ—Ä–∏–µ–π –∏–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π, –Ω–∞—á–∏–Ω–∞—é—â–∏–π—Å—è —Å –∂–∏—Ä–Ω–æ–≥–æ —Ö—É–∫–∞.
–ü–æ—Å—Ç 3 (–í–µ—á–µ—Ä): –í—Ç–æ—Ä–æ–π –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å –¥–Ω–µ–≤–Ω—É—é —Ç–µ–º—É, –Ω–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –Ω–∞ –¥—Ä—É–≥—É—é —Ç–µ–º—É –∏–∑ –¥—Ä—É–≥–æ–π —Ä—É–±—Ä–∏–∫–∏, —Ç–∞–∫–∂–µ –Ω–∞—á–∏–Ω–∞—é—â–∏–π—Å—è —Å –∂–∏—Ä–Ω–æ–≥–æ —Ö—É–∫–∞.

–†—É–±—Ä–∏–∫–∏ –∫–∞–Ω–∞–ª–∞ –¥–ª—è –ø–æ—Å—Ç–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –û—Ç–Ω–æ—à–µ–Ω–∏–π:
#–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è–ü–æ–Ω–∏–º–∞–Ω–∏—è: –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–ª—É—à–∞–Ω–∏–µ, —ç–º–ø–∞—Ç–∏—è.
#–Ø–∑—ã–∫–∏–õ—é–±–≤–∏: –†–∞–∑–±–æ—Ä 5 —è–∑—ã–∫–æ–≤ –ª—é–±–≤–∏.
#–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç–í–ü–∞—Ä–µ: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–º–æ—Ü–∏—è–º–∏, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –±–ª–∏–∑–æ—Å—Ç—å.
#–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã:–£–ø—Ä–∞–≤–ª—è–µ–º: –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–ø–æ—Ä–æ–≤.
#–î–æ–≤–µ—Ä–∏–µ VS –°–æ–º–Ω–µ–Ω–∏—è: –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∏ —É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –¥–æ–≤–µ—Ä–∏—è.
#–ü–æ–¥–¥–µ—Ä–∂–∫–∞–ö–∞–∫–û—Å–Ω–æ–≤–∞: –ö–∞–∫ –±—ã—Ç—å –æ–ø–æ—Ä–æ–π –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞.
#–£–≤–∞–∂–µ–Ω–∏–µ: –í–∞—à –ò –ï–≥–æ: –í–∑–∞–∏–º–Ω–æ–µ —É–≤–∞–∂–µ–Ω–∏–µ.
#–ì—Ä–∞–Ω–∏—Ü—ã–í–û—Ç–Ω–æ—à–µ–Ω–∏—è—Ö: –ó–¥–æ—Ä–æ–≤—ã–µ –ª–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã.
#–≠—Ç–∞–ø—ã–û—Ç–Ω–æ—à–µ–Ω–∏–π: –°—Ç–∞–¥–∏–∏ —Ä–∞–∑–≤–∏—Ç–∏—è, –∫—Ä–∏–∑–∏—Å—ã.
#–¢–∞–∫—Ç–∏–ª—å–Ω–æ—Å—Ç—å: –ë–æ–ª—å—à–µ –ß–µ–º –°–µ–∫—Å: –ù–µ–≤–µ—Ä–±–∞–ª—å–Ω–æ–µ –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –ª—é–±–≤–∏.

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ú–∏—Ä–æ–≤—ã–µ –î–∞–Ω–Ω—ã–µ:
#–¶–∏—Ñ—Ä—ã–û–†–∞–∑–≤–æ–¥–∞—Ö: –î–∞–Ω–Ω—ã–µ –ø–æ –±—Ä–∞–∫–∞–º, —Ä–∞–∑–≤–æ–¥–∞–º, –∏—Ö –ø—Ä–∏—á–∏–Ω–∞–º.
#–°–µ–º—å—è–ò–î–µ—Ç–∏: –î–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç—å, –≤–ª–∏—è–Ω–∏–µ –¥–µ—Ç–µ–π –Ω–∞ —Å—á–∞—Å—Ç—å–µ.
#–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ–ë—Ä–∞–∫–∏: –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –º–µ–∂–¥—É –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è–º–∏ —Ä–∞–∑–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä.
#–ü–æ–∫–æ–ª–µ–Ω–∏—è–¶–µ–Ω–Ω–æ—Å—Ç–µ–π: –≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –æ –±—Ä–∞–∫–µ –∏ —Å–µ–º—å–µ.

–õ—É—á—à–∏–µ –ú–∏—Ä–æ–≤—ã–µ –ü—Ä–∞–∫—Ç–∏–∫–∏ –∏ –°–æ–≤–µ—Ç—ã:
#–°–∏–ª—å–Ω—ã–µ–ü–∞—Ä—ã–ú–∏—Ä–∞: –û—Ç–Ω–æ—à–µ–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–∞—Ä.
#–ú—É–¥—Ä–æ—Å—Ç—å–í–µ–∫–æ–≤–û–õ—é–±–≤–∏: –¶–∏—Ç–∞—Ç—ã –∏ —Å–æ–≤–µ—Ç—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏.
#–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ–¢–µ—Ö–Ω–∏–∫–∏–û—Ç–Ω–æ—à–µ–Ω–∏–π: –ù–æ–≤—ã–µ –ø–æ–¥—Ö–æ–¥—ã –≤ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏.
#–ü—Ä–∞–∫—Ç–∏–∫—É–º–î–ª—è–ü–∞—Ä—ã: –ó–∞–¥–∞–Ω–∏—è –¥–ª—è –ø–∞—Ä.
#–í–µ—Ä–Ω—É—Ç—å–ò—Å–∫—Ä—É: –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–æ–º–∞–Ω—Ç–∏–∫–∏ –∏ —Å—Ç—Ä–∞—Å—Ç–∏.

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –í–∑–≥–ª—è–¥ –Ω–∞ –û—Ç–Ω–æ—à–µ–Ω–∏—è:
#–ù–µ–¢–æ–ª—å–∫–æ–î–µ–Ω—å–≥–∏: –ò—Å—Ç–æ—Ä–∏–∏, –≥–¥–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—Å–ø–µ—Ö –Ω–µ —Ä–∞–≤–µ–Ω —Å—á–∞—Å—Ç—å—é.
#–ö–æ–≥–¥–∞–û—à–∏–±–ª–∏—Å—å–°–í—ã–±–æ—Ä–æ–º: –û—Å–æ–∑–Ω–∞–Ω–∏–µ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞, –≤—ã—Ö–æ–¥ –∏–∑ –æ—Ç–Ω–æ—à–µ–Ω–∏–π.
#–≠–≤–æ–ª—é—Ü–∏—è–°–µ–º–µ–π–Ω—ã—Ö–¶–µ–Ω–Ω–æ—Å—Ç–µ–π: –í–ª–∏—è–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤ –Ω–∞ –∏–Ω—Å—Ç–∏—Ç—É—Ç –±—Ä–∞–∫–∞.
#–ö—Ä–∏—Ç–µ—Ä–∏–∏–í—ã–±–æ—Ä–∞–ü–∞—Ä—Ç–Ω–µ—Ä–∞: –ö–∞—á–µ—Å—Ç–≤–∞, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω—ã–µ, –ø–æ–º–∏–º–æ —Å—Ç–∞—Ç—É—Å–∞ –∏ –¥–µ–Ω–µ–≥.
#–ò—Å—Ç–æ—Ä–∏–∏–õ—é–±–≤–∏–ê–ù–µ–î–µ–Ω–µ–≥: –ü—Ä–∏–º–µ—Ä—ã –ø–∞—Ä, –≥–¥–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∞–∂–Ω–µ–µ –≤—Å–µ–≥–æ.

–õ–∏—á–Ω—ã–µ –∏ –°–µ–º–µ–π–Ω—ã–µ –¶–µ–Ω–Ω–æ—Å—Ç–∏:
#–°–µ–º–µ–π–Ω—ã–µ–¢—Ä–∞–¥–∏—Ü–∏–∏: –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç—Ä–∞–¥–∏—Ü–∏–π.
#–°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ–í–ü–∞—Ä–µ: –°–æ–≤–º–µ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç.
#–ó–∞–±–æ—Ç–∞–û–°–µ–±–µ: –í–ª–∏—è–Ω–∏–µ –ù–∞ –û—Ç–Ω–æ—à–µ–Ω–∏—è: –õ–∏—á–Ω–æ–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ.
#–î–µ—Ç–∏–ò–û—Ç–Ω–æ—à–µ–Ω–∏—è: –ì–∞—Ä–º–æ–Ω–∏—è –≤ –ø–∞—Ä–µ –ø–æ—Å–ª–µ —Ä–æ–∂–¥–µ–Ω–∏—è –¥–µ—Ç–µ–π.
#–°–æ–∑–¥–∞–Ω–∏–µ–°–µ–º–µ–π–Ω–æ–≥–æ–ì–Ω–µ–∑–¥–∞: –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ –¥–æ–º–∞.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –†—É–±—Ä–∏–∫–∏ –¥–ª—è –¶–∏—Ç–∞—Ç/–ú—É–¥—Ä–æ—Å—Ç–∏:
#–ú—É–¥—Ä–æ—Å—Ç—å–î–Ω—è: –û–±—â–∏–µ —Ü–∏—Ç–∞—Ç—ã (—Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ, –ø–æ–∑–∏—Ç–∏–≤).
#–¶–∏—Ç–∞—Ç–∞–û—Ç–Ω–æ—à–µ–Ω–∏–π: –§–æ–∫—É—Å –Ω–∞ –ª—é–±–æ–≤—å, –ø–∞—Ä—É, —Å–µ–º—å—é.
#–ú—ã—Å–ª–∏–í—Å–ª—É—Ö: –ê–≤—Ç–æ—Ä—Å–∫–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è, –∏–Ω—Å–∞–π—Ç—ã.
#–°–æ–≤–ø–∞–ª–æ: –¶–∏—Ç–∞—Ç—ã, —Ç–æ—á–Ω–æ –æ—Ç—Ä–∞–∂–∞—é—â–∏–µ –º–∏—Å—Å–∏—é –∫–∞–Ω–∞–ª–∞.
#–ß–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å: –¶–∏—Ç–∞—Ç—ã –æ –¥–æ–±—Ä–æ—Ç–µ, —ç–º–ø–∞—Ç–∏–∏, –ø—Ä–∏–Ω—è—Ç–∏–∏.

–¢–í–û–Ø –û–°–ù–û–í–ù–ê–Ø –ó–ê–î–ê–ß–ê: –°–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –Ω–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ –ª—é–±–≤–∏ –∏ —Å–µ–º—å–µ, –æ–±—É—á–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∞—É–¥–∏—Ç–æ—Ä–∏—é –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã—Ö –∏ —Å—á–∞—Å—Ç–ª–∏–≤—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π, –Ω–µ –Ω–∞–≤—è–∑—á–∏–≤–æ –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å –∞—É–¥–∏—Ç–æ—Ä–∏—é —Ç–æ–º—É,—á—Ç–æ –æ–Ω–∏ –ø–æ–¥–±–∏—Ä–∞–ª–∏ —Å–µ–±–µ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ü–µ–Ω–Ω–æ—Å—Ç—è–º, –∞ –Ω–µ –ø–æ –≤–Ω–µ—à–Ω–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º –∏–ª –ø–æ –¥–µ–Ω–µ–∂–Ω–æ–º—É –¥–æ—Å—Ç–∞—Ç–∫—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞"""

    async def generate_weekly_posts(self) -> List[Dict[str, Any]]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ—Å—Ç—ã –Ω–∞ 3 –¥–Ω—è (9 –ø–æ—Å—Ç–æ–≤)"""
        logger.info("üéØ –ù–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–æ—Å—Ç–æ–≤ –Ω–∞ 3 –¥–Ω—è")
        
        posts = []
        start_date = datetime.now()
        
        for day in range(3):  # –¢–æ–ª—å–∫–æ 3 –¥–Ω—è
            current_date = start_date + timedelta(days=day)
            date_str = current_date.strftime("%d.%m.%y")
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3 –ø–æ—Å—Ç–∞ –Ω–∞ –¥–µ–Ω—å
            for post_type in ["—É—Ç—Ä–æ", "–¥–µ–Ω—å", "–≤–µ—á–µ—Ä"]:
                post_data = await self._generate_single_post(date_str, post_type)
                if post_data:
                    posts.append(post_data)
        
        logger.info(f"‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ {len(posts)} –ø–æ—Å—Ç–æ–≤ –Ω–∞ 3 –¥–Ω—è")
        return posts

    async def _generate_single_post(self, date: str, post_type: str) -> Dict[str, Any]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–¥–∏–Ω –ø–æ—Å—Ç"""
        try:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
            if post_type == "—É—Ç—Ä–æ":
                time = "08:00"
                prompt = """–°–æ–∑–¥–∞–π —É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Å—Ç-—Ü–∏—Ç–∞—Ç—É –¥–ª—è –∫–∞–Ω–∞–ª–∞ "–°–æ–≤–ø–∞–ª–∏".

        –í–ê–ñ–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
        - –¢–û–õ–¨–ö–û —Ü–∏—Ç–∞—Ç–∞, –±–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!"
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã
        - –ù–ï —É–∫–∞–∑—ã–≤–∞–π –∞–≤—Ç–æ—Ä–∞ —Ü–∏—Ç–∞—Ç—ã
        - –ò—Å–ø–æ–ª—å–∑—É–π Markdown —Ä–∞–∑–º–µ—Ç–∫—É: > –¥–ª—è —Ü–∏—Ç–∞—Ç—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
        - –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π *–∫—É—Ä—Å–∏–≤* –¥–ª—è —Ü–∏—Ç–∞—Ç—ã
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π —Ö—ç—à—Ç–µ–≥–∏
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Midjourney
        - –î–ª–∏–Ω–∞: 50-200 —Å–∏–º–≤–æ–ª–æ–≤ (–∫–æ—Ä–æ—Ç–∫–∞—è –º—É–¥—Ä–∞—è —Ü–∏—Ç–∞—Ç–∞)
        - –¢–æ–ª—å–∫–æ —Å–∞–º–∞ —Ü–∏—Ç–∞—Ç–∞ —Å Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        
        –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:
        > –õ—é–±–æ–≤—å ‚Äì —ç—Ç–æ –Ω–µ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞, –∞ –∫–æ–≥–¥–∞ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –æ–¥–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏."""
            elif post_type == "–¥–µ–Ω—å":
                time = "14:00"
                prompt = """–°–æ–∑–¥–∞–π –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç –¥–ª—è –¥–Ω–µ–≤–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.
        
        –í–ê–ñ–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
        - –ü–æ—Å—Ç –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å —Ö—É–∫–∞
        - –°–æ–¥–µ—Ä–∂–∞—Ç—å –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑, –∏—Å—Ç–æ—Ä–∏—é –∏–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        - –ò—Å–ø–æ–ª—å–∑—É–π –æ–¥–Ω—É –∏–∑ —Ä—É–±—Ä–∏–∫ –∫–∞–Ω–∞–ª–∞
        - –î–ª–∏–Ω–∞ –ø–æ—Å—Ç–∞: 800-1500 —Å–∏–º–≤–æ–ª–æ–≤ (—Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞)
        - –ò—Å–ø–æ–ª—å–∑—É–π HTML —Ç–µ–≥–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        - –ò—Å–ø–æ–ª—å–∑—É–π <b>–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</b>, <i>–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç</i>, <u>–ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç</u>, <s>–∑–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç</s>, <code>–º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç</code>
        - –ò—Å–ø–æ–ª—å–∑—É–π <br> –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
        - –ò—Å–ø–æ–ª—å–∑—É–π <ul><li>—Å–ø–∏—Å–∫–∏</li></ul> –¥–ª—è —Å–ø–∏—Å–∫–æ–≤
        - –ò—Å–ø–æ–ª—å–∑—É–π <a href="url">—Å—Å—ã–ª–∫–∏</a> –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å—Å—ã–ª–æ–∫
        - –ò—Å–ø–æ–ª—å–∑—É–π <blockquote>—Ü–∏—Ç–∞—Ç—ã</blockquote> –¥–ª—è –≤–∞–∂–Ω—ã—Ö –º—ã—Å–ª–µ–π
        - –í–∫–ª—é—á–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π —Ö—ç—à—Ç–µ–≥–∏
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Midjourney
        - –¢–æ–ª—å–∫–æ —Å–∞–º —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ —Å HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        
        –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:
        <b>–ü–û–ß–ï–ú–£ –ú–´ –¢–ï–†–Ø–ï–ú –°–í–Ø–ó–¨ –° –ë–õ–ò–ó–ö–ò–ú–ò?</b><br><br>
        –ß–∞—Å—Ç–æ –º—ã –¥—É–º–∞–µ–º, —á—Ç–æ –∑–Ω–∞–µ–º —Å–≤–æ–µ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ...<br><br>
        <i>–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å:</i> –≥—Ä–∞–Ω–∏—Ü—ã ‚Äî —ç—Ç–æ –Ω–µ —Å—Ç–µ–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–¥–µ–ª—è–µ—Ç, –∞ –∫–∞—Ä–∫–∞—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–µ—Ä–∂–∏—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫—Ä–µ–ø–∫–∏–º–∏ –∏ –∑–¥–æ—Ä–æ–≤—ã–º–∏."""
            else:  # –≤–µ—á–µ—Ä
                time = "20:00"
                prompt = """–°–æ–∑–¥–∞–π –≤–µ—á–µ—Ä–Ω–∏–π –ø–æ—Å—Ç.
        
        –í–ê–ñ–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
        - –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ç–æ—Ä–æ–π –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç –Ω–∞ –¥—Ä—É–≥—É—é —Ç–µ–º—É –∏–∑ –¥—Ä—É–≥–æ–π —Ä—É–±—Ä–∏–∫–∏
        - –¢–∞–∫–∂–µ –Ω–∞—á–∏–Ω–∞—é—â–∏–π—Å—è —Å —Ö—É–∫–∞
        - –î–ª–∏–Ω–∞ –ø–æ—Å—Ç–∞: 800-2000 —Å–∏–º–≤–æ–ª–æ–≤ (—Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞)
        - –ò—Å–ø–æ–ª—å–∑—É–π Markdown —Ä–∞–∑–º–µ—Ç–∫—É –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        - –ò—Å–ø–æ–ª—å–∑—É–π **–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç**, *–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç*, __–ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç__, ~~–∑–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç~~
        - –ò—Å–ø–æ–ª—å–∑—É–π ## –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
        - –ò—Å–ø–æ–ª—å–∑—É–π - –¥–ª—è —Å–ø–∏—Å–∫–æ–≤
        - –ò—Å–ø–æ–ª—å–∑—É–π [—Å—Å—ã–ª–∫–∏](url) –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å—Å—ã–ª–æ–∫
        - –ò—Å–ø–æ–ª—å–∑—É–π > —Ü–∏—Ç–∞—Ç—ã –¥–ª—è –≤–∞–∂–Ω—ã—Ö –º—ã—Å–ª–µ–π
        - –ò—Å–ø–æ–ª—å–∑—É–π `–∫–æ–¥` –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
        - –í–∫–ª—é—á–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π —Ö—ç—à—Ç–µ–≥–∏
        - –ù–ï –¥–æ–±–∞–≤–ª—è–π –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Midjourney
        - –¢–æ–ª—å–∫–æ —Å–∞–º —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ —Å Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        
        –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:
        **–ö–ê–ö –í–û–°–°–¢–ê–ù–û–í–ò–¢–¨ –î–û–í–ï–†–ò–ï –í –û–¢–ù–û–®–ï–ù–ò–Ø–•?**
        
        –î–æ–≤–µ—Ä–∏–µ ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –ª—é–±—ã—Ö –∑–¥–æ—Ä–æ–≤—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π...
        
        *–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å:* –¥–æ–≤–µ—Ä–∏–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–µ –∑–∞ –æ–¥–∏–Ω –¥–µ–Ω—å, –Ω–æ —Ä–∞–∑—Ä—É—à–∞–µ—Ç—Å—è –≤ –æ–¥–∏–Ω –º–æ–º–µ–Ω—Ç."""
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ—Å—Ç —Å HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
            post_text = await self._call_openrouter_api(prompt)
            if not post_text:
                return None
            
            # –û—á–∏—â–∞–µ–º –ø–æ—Å—Ç –æ—Ç –ª–∏—à–Ω–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏
            if time == "14:00":  # –î–Ω–µ–≤–Ω–æ–π –ø–æ—Å—Ç - HTML
                cleaned_post = self._clean_html_post(post_text)
            else:  # –£—Ç—Ä–µ–Ω–Ω–∏–π –∏ –≤–µ—á–µ—Ä–Ω–∏–π –ø–æ—Å—Ç—ã - Markdown (–¥–ª—è –ø–æ—Å—Ç–æ–≤ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
                cleaned_post = self._clean_markdown_post(post_text)
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Midjourney
            midjourney_prompt_ru = await self._generate_midjourney_prompt(post_text, "ru")
            midjourney_prompt_en = await self._generate_midjourney_prompt(post_text, "en")
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–Ω–µ–≤–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ (14:00)
            image_field = ""
            if time == "14:00":
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                image_field = "https://picsum.photos/800/600?random=1"
            
            return {
                "date": date,
                "time": time,
                "post": cleaned_post,  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—á–∏—â–µ–Ω–Ω—ã–π –ø–æ—Å—Ç
                "midjourney_ru": midjourney_prompt_ru,
                "midjourney_en": midjourney_prompt_en,
                "image": image_field,  # –ü—É—Å—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è —É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏ –≤–µ—á–µ—Ä–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤
                "status": "–û–∂–∏–¥–∞–µ—Ç"
            }
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å—Ç–∞ {post_type} –Ω–∞ {date}: {e}")
            return None

    async def _call_openrouter_api(self, prompt: str) -> str:
        """–í—ã–∑—ã–≤–∞–µ—Ç OpenRouter API –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞"""
        try:
            headers = {
                "Authorization": f"Bearer {self.openrouter_api_key}",
                "Content-Type": "application/json"
            }
            
            data = {
                "model": self.model,
                "messages": [
                    {"role": "system", "content": self.system_prompt},
                    {"role": "user", "content": prompt}
                ],
                "max_tokens": 3000,
                "temperature": 0.8
            }
            
            async with aiohttp.ClientSession() as session:
                async with session.post(self.api_url, headers=headers, json=data) as response:
                    if response.status == 200:
                        result = await response.json()
                        return result["choices"][0]["message"]["content"].strip()
                    else:
                        logger.error(f"–û—à–∏–±–∫–∞ API: {response.status}")
                        return None
                        
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≤—ã–∑–æ–≤–∞ OpenRouter API: {e}")
            return None

    def _format_post_for_telegram(self, text: str) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø–æ—Å—Ç –¥–ª—è Telegram —Å HTML —Ç–µ–≥–∞–º–∏"""
        if not text:
            return ""
        
        # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º Markdown –≤ HTML –¥–ª—è Telegram
        import re
        
        # –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç **text** -> <b>text</b>
        text = re.sub(r'\*\*(.*?)\*\*', r'<b>\1</b>', text)
        
        # –ö—É—Ä—Å–∏–≤ *text* -> <i>text</i>
        text = re.sub(r'\*(.*?)\*', r'<i>\1</i>', text)
        
        # –ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ _text_ -> <u>text</u>
        text = re.sub(r'_(.*?)_', r'<u>\1</u>', text)
        
        # –ó–∞—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ ~~text~~ -> <s>text</s>
        text = re.sub(r'~~(.*?)~~', r'<s>\1</s>', text)
        
        # –ú–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π `text` -> <code>text</code>
        text = re.sub(r'`(.*?)`', r'<code>\1</code>', text)
        
        # –°—Å—ã–ª–∫–∏ [text](url) -> <a href="url">text</a>
        text = re.sub(r'\[([^\]]+)\]\(([^)]+)\)', r'<a href="\2">\1</a>', text)
        
        # –ü–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
        text = text.replace('\n', '<br>')
        
        return text

    def _clean_markdown_post(self, text: str) -> str:
        """–û—á–∏—â–∞–µ—Ç –ø–æ—Å—Ç –æ—Ç –ª–∏—à–Ω–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç Markdown –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ"""
        if not text:
            return ""
        
        import re
        
        # –£–±–∏—Ä–∞–µ–º HTML —Ç–µ–≥–∏ (–Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º Markdown)
        text = re.sub(r'<[^>]+>', '', text)
        
        # –£–±–∏—Ä–∞–µ–º —Ö—ç—à—Ç–µ–≥–∏
        text = re.sub(r'#\w+', '', text)
        
        # –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Midjourney (–µ—Å–ª–∏ –æ–Ω–∏ –ø–æ–ø–∞–ª–∏ –≤ –ø–æ—Å—Ç)
        text = re.sub(r'–ü—Ä–æ–º–ø—Ç –¥–ª—è Midjourney.*', '', text, flags=re.DOTALL)
        text = re.sub(r'Midjourney prompt.*', '', text, flags=re.DOTALL)
        text = re.sub(r'\*\*–ü—Ä–æ–º–ø—Ç –¥–ª—è Midjourney:\*\*.*', '', text, flags=re.DOTALL)
        text = re.sub(r'\*\*Midjourney Prompt:\*\*.*', '', text, flags=re.DOTALL)
        
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
        text = re.sub(r'\n\s*\n\s*\n', '\n\n', text)
        
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        text = re.sub(r' +', ' ', text)
        
        # –û—á–∏—â–∞–µ–º –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü
        text = text.strip()
        
        return text
        
    def _clean_html_post(self, text: str) -> str:
        """–û—á–∏—â–∞–µ—Ç –ø–æ—Å—Ç –æ—Ç –ª–∏—à–Ω–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç HTML —Ç–µ–≥–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ"""
        if not text:
            return ""
        
        import re
        
        # –£–±–∏—Ä–∞–µ–º —Ö—ç—à—Ç–µ–≥–∏
        text = re.sub(r'#\w+', '', text)
        
        # –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Midjourney (–µ—Å–ª–∏ –æ–Ω–∏ –ø–æ–ø–∞–ª–∏ –≤ –ø–æ—Å—Ç)
        text = re.sub(r'–ü—Ä–æ–º–ø—Ç –¥–ª—è Midjourney.*', '', text, flags=re.DOTALL)
        text = re.sub(r'Midjourney prompt.*', '', text, flags=re.DOTALL)
        text = re.sub(r'<b>–ü—Ä–æ–º–ø—Ç –¥–ª—è Midjourney:</b>.*', '', text, flags=re.DOTALL)
        text = re.sub(r'<b>Midjourney Prompt:</b>.*', '', text, flags=re.DOTALL)
        
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
        text = re.sub(r'\n\s*\n\s*\n', '\n\n', text)
        
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        text = re.sub(r' +', ' ', text)
        
        # –û—á–∏—â–∞–µ–º –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü
        text = text.strip()
        
        return text

    def _convert_markdown_to_html(self, text: str) -> str:
        """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Markdown –≤ HTML –¥–ª—è Telegram"""
        if not text:
            return ""
        
        import re
        
        # –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç **text** -> <b>text</b>
        text = re.sub(r'\*\*(.*?)\*\*', r'<b>\1</b>', text)
        
        # –ö—É—Ä—Å–∏–≤ *text* -> <i>text</i>
        text = re.sub(r'\*(.*?)\*', r'<i>\1</i>', text)
        
        # –ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ _text_ -> <u>text</u>
        text = re.sub(r'_(.*?)_', r'<u>\1</u>', text)
        
        # –ó–∞—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ ~~text~~ -> <s>text</s>
        text = re.sub(r'~~(.*?)~~', r'<s>\1</s>', text)
        
        # –ú–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π `text` -> <code>text</code>
        text = re.sub(r'`(.*?)`', r'<code>\1</code>', text)
        
        # –°—Å—ã–ª–∫–∏ [text](url) -> <a href="url">text</a>
        text = re.sub(r'\[([^\]]+)\]\(([^)]+)\)', r'<a href="\2">\1</a>', text)
        
        # –ü–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
        text = text.replace('\n', '<br>')
        
        return text

    async def _generate_midjourney_prompt(self, post_text: str, language: str) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è Midjourney"""
        try:
            if language == "ru":
                prompt = f"""–°–æ–∑–¥–∞–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Midjourney –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –¥–ª—è –ø–æ—Å—Ç–∞.

–í–ê–ñ–ù–û:
- –¢–æ–ª—å–∫–æ –ø—Ä–æ–º–ø—Ç –¥–ª—è Midjourney, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- –ë–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –ë–µ–∑ HTML —Ç–µ–≥–æ–≤
- –¢–æ–ª—å–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

–ü–æ—Å—Ç: {post_text[:500]}

–ü—Ä–æ–º–ø—Ç:"""
            else:
                prompt = f"""Create a Midjourney prompt in English for this post.

IMPORTANT:
- Only the Midjourney prompt, no additional text
- No explanations or comments
- No HTML tags
- Only image description in English

Post: {post_text[:500]}

Prompt:"""
            
            result = await self._call_openrouter_api(prompt)
            # –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞
            if result:
                # –£–±–∏—Ä–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã
                result = result.replace("–ü—Ä–æ–º–ø—Ç:", "").replace("Prompt:", "").strip()
                result = result.replace("**–ü—Ä–æ–º–ø—Ç –¥–ª—è Midjourney:**", "").strip()
                result = result.replace("**Midjourney Prompt:**", "").strip()
                return result
            return ""
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Midjourney –ø—Ä–æ–º–ø—Ç–∞: {e}")
            return ""

    async def initialize_sheet_headers(self) -> bool:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã"""
        try:
            logger.info("üìã –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã")
            
            headers = [
                "–î–∞—Ç–∞",
                "–í—Ä–µ–º—è", 
                "–ü–æ—Å—Ç",
                "–ü—Ä–æ–º–ø—Ç RU",
                "–ü—Ä–æ–º–ø—Ç EN",
                "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",
                "–°—Ç–∞—Ç—É—Å"
            ]
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
            existing_data = self.sheets_client.get_all_posts()
            if existing_data and len(existing_data) > 0:
                logger.info("–ó–∞–≥–æ–ª–æ–≤–∫–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç")
                return True
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
            result = self.sheets_client.add_post(headers)
            if result:
                logger.info("‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã")
                return True
            else:
                logger.error("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤")
                return False
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: {e}")
            return False

    async def upload_posts_to_sheets(self, posts: List[Dict[str, Any]]) -> bool:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ—Å—Ç—ã –≤ Google –¢–∞–±–ª–∏—Ü—É"""
        try:
            logger.info(f"üì§ –ó–∞–≥—Ä—É–∂–∞–µ–º {len(posts)} –ø–æ—Å—Ç–æ–≤ –≤ Google –¢–∞–±–ª–∏—Ü—É")
            
            for post in posts:
                post_row = [
                    post["date"],
                    post["time"],
                    post["post"],
                    post["midjourney_ru"],
                    post["midjourney_en"],
                    post["image"],
                    post["status"]
                ]
                
                result = self.sheets_client.add_post(post_row)
                if not result:
                    logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–∞ {post['date']} {post['time']}")
                    return False
            
            logger.info("‚úÖ –í—Å–µ –ø–æ—Å—Ç—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É")
            return True
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É: {e}")
            return False

    async def generate_and_upload_weekly_posts(self) -> bool:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ—Å—Ç—ã –Ω–∞ 3 –¥–Ω—è"""
        try:
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
            headers_success = await self.initialize_sheet_headers()
            if not headers_success:
                logger.error("–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã")
                return False
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ—Å—Ç—ã
            posts = await self.generate_weekly_posts()
            if not posts:
                logger.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç—ã")
                return False
            
            # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ —Ç–∞–±–ª–∏—Ü—É
            success = await self.upload_posts_to_sheets(posts)
            if success:
                logger.info("üéâ –ü–æ—Å—Ç—ã –Ω–∞ 3 –¥–Ω—è —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!")
                return True
            else:
                logger.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É")
                return False
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–æ–≤: {e}")
            return False

async def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    generator = AIPostGenerator()
    success = await generator.generate_and_upload_weekly_posts()
    
    if success:
        print("‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
    else:
        print("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤")

if __name__ == "__main__":
    asyncio.run(main())
